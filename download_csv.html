<script src="https://d3js.org/d3.v4.js"></script>
<script>
var data = [
   ['Foo', 'programmer'],
   ['Bar', 'bus driver'],
   ['Moo', 'Reindeer Hunter']
];
 
 
function download_csv() {
var dataset = [];
d3.csv("stockCodeList.csv", function(data) {
	dataset = data.map(function(d) { return [d["code"], d["name"]];});
});

console.log(dataset);

    var csv = 'Name,Title\n';
    data.forEach(function(row) {
            csv += row.join(',');
            csv += "\n";
    });
 
    console.log(csv);
    var hiddenElement = document.createElement('a');
    hiddenElement.href = 'data:text/csv;charset=utf-8,' + encodeURI(csv);
    hiddenElement.target = '_blank';
    hiddenElement.download = 'people.csv';
    hiddenElement.click();
}
</script>
 
<button onclick="download_csv()">Download CSV</button> 